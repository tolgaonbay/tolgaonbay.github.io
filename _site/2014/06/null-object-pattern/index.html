<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      Null Object Pattern &middot; Things to Code
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="/public/css/lanyon.css">
  <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700|PT+Sans:400">

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-precomposed.png">
  <link rel="shortcut icon" href="/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">

  
  <meta name="description" content="Null Object Pattern is actually a special form of Special Case pattern. It gives a null meaning to your object and prevents getting null reference error" />
  
  <script src="/assets/jquery-1.11.1.min.js"></script>
  <script>
    $( document ).ready(function() {
      $('img').parents('p').attr('align', 'center');
    });
  </script>
</head>


  <body>

    <!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
     styles, `#sidebar-checkbox` for behavior. -->
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">

<!-- Toggleable sidebar -->
<div class="sidebar" id="sidebar">
  <div class="sidebar-item">
    <p></p>
  </div>

  <nav class="sidebar-nav">
    <a class="sidebar-nav-item" href="/">Home</a>

    
    <a class="sidebar-nav-item" href="/about/">About</a>
    <a class="sidebar-nav-item" href="/archive/">Archive</a>
    <a class="sidebar-nav-item" href="/atom.xml">RSS</a>
    <!--
    
    
      
        
      
    
      
    
      
        
      
    
      
        
          <a class="sidebar-nav-item" href="/about/index.html">About</a>
        
      
    
      
        
          <a class="sidebar-nav-item" href="/archive/index.html">Archive</a>
        
      
    
    -->
  </nav>

  <div class="sidebar-item">
    <p>
      &copy; 2014. All rights reserved.
    </p>
  </div>
</div>


    <!-- Wrap is the content to shift when toggling the sidebar. We wrap the
         content to avoid any CSS collisions with our real content. -->
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <h3 class="masthead-title">
            <a href="/" title="Home">Things to Code</a>
            <small></small>
          </h3>
        </div>
      </div>

      <div class="container content">
        <div class="post">
  <h1 class="post-title">Null Object Pattern</h1>
  <span class="post-date">10 Jun 2014</span>
  <p>A couple of months ago I needed to write a logging mechanism where logs weren&#39;t
always necessary to be persisted and log objects had to be transferred between
methods, so each method assigns some specific attributes of the log object
before being persisted. I know the latter seems like a terrible design, but not
everybody can work on a state-of-the-art system like some lucky guys do!</p>

<p>You can get a feeling of the log class below:</p>

<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">AuditLog</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">id</span><span class="o">;</span>
    <span class="o">...</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getId</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">id</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setId</span><span class="o">(</span><span class="n">String</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">id</span> <span class="o">=</span> <span class="n">id</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="o">...</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">save</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">//Persist to database</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre></div>

<p>Standard procedure is of course passing null reference to the methods when
there is no need to log and afterwards checking if the object is not null, so
you can invoke its methods without getting a null reference exception.</p>

<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">TransactionHandler</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">handle</span><span class="o">(</span><span class="n">Transaction</span> <span class="n">transaction</span><span class="o">,</span> <span class="n">AuditLog</span> <span class="n">log</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">log</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span>
            <span class="n">log</span><span class="o">.</span><span class="na">setId</span><span class="o">(</span><span class="n">id</span><span class="o">);</span>
        <span class="o">...</span>
    <span class="o">}</span>
    <span class="o">...</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">log</span><span class="o">(</span><span class="n">AuditLog</span> <span class="n">log</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">log</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span>
            <span class="n">log</span><span class="o">.</span><span class="na">save</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre></div>

<p>If you are an Objective-C programmer, then you are lucky, you don&#39;t need to
worry about checking if the object is null. But if you are using a mainstream
object oriented programming language like me, you need to keep in mind that the
objects can be null.</p>

<p>When you need to check null reference multiple times in more than a
few methods, then your code is going to start smelling. You should start
thinking about something else. Null Object Pattern can be your way out.</p>

<h2>Null Object Pattern</h2>

<p>Null Object Pattern is actually a special form of <a href="http://martinfowler.com/eaaCatalog/specialCase.html">Special
Case</a> pattern. It gives a
null meaning to your object and prevents getting null reference error and the
best part is: invoking its methods does nothing and there&#39;s no need to check if
it is null. It will cost you a method call instead of an if statement, but you
will get a cleaner code.</p>

<p>Let&#39;s get back to the design. We can transform the AuditLog class to use the
Null Object pattern like below.</p>

<p><img src="http://www.thingstocode.com/assets/2014/04/nullobjectpattern.png" alt="null object pattern"></p>

<p>The code will simply be changed to:</p>

<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">AuditLog</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getId</span><span class="o">();</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setId</span><span class="o">(</span><span class="n">String</span> <span class="n">id</span><span class="o">);</span>
    <span class="o">...</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">save</span><span class="o">();</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">AuditLogImpl</span> <span class="kd">implements</span> <span class="n">AuditLog</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">id</span><span class="o">;</span>
    <span class="o">...</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getId</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">id</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setId</span><span class="o">(</span><span class="n">String</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">id</span> <span class="o">=</span> <span class="n">id</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="o">...</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">save</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">//Persist to database</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">NullAuditLog</span> <span class="kd">implements</span> <span class="n">AuditLog</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getId</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setId</span><span class="o">(</span><span class="n">String</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">//Do nothing</span>
    <span class="o">}</span>
    <span class="o">...</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">save</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">//Do nothing</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre></div>

<p>Invoking the save method with a NullAuditLog instance will do nothing and you
don&#39;t need to add a null reference check anymore.</p>

<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">TransactionHandler</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">handle</span><span class="o">(</span><span class="n">Transaction</span> <span class="n">transaction</span><span class="o">,</span> <span class="n">AuditLog</span> <span class="n">log</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">log</span><span class="o">.</span><span class="na">setId</span><span class="o">(</span><span class="n">id</span><span class="o">);</span>
        <span class="o">...</span>
    <span class="o">}</span>
    <span class="o">...</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">log</span><span class="o">(</span><span class="n">AuditLog</span> <span class="n">log</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">log</span><span class="o">.</span><span class="na">save</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre></div>

<p>Actually using an interface is the optimal usage. But in my design, I simply
extended AuditLog class as NullAuditLog and made it a private static
class inside of the AuditLog class. With this way null instance may have been
retrieved from the NULL constant defined in AuditLog class. You can have a look
at it on
<a href="https://github.com/tolgaonbay/examples/blob/master/src/com/thingstocode/examples/nullobject/AuditLog.java">github</a>.</p>

<p>There are some downsides of this usage, like when you add new methods to the
class, you should remember to add them into your null class. With an interface
it is clearer to add method definitions into your interface and implement them
in the derived classes.</p>

<h2>Conclusion</h2>

<p>Even if it came out because of a <a href="http://www.infoq.com/presentations/Null-References-The-Billion-Dollar-Mistake-Tony-Hoare">billion dollar
mistake</a>,
Null Object Pattern is very handy and makes your code clean. This doesn&#39;t mean
that you should apply Null Object Pattern to every single class in your design
- it can make things even more complicated and error-prone. It may be
used when:</p>

<ul>
<li>  It is possible to have a null reference and assigning null reference has a
meaning in the design. For example we used it to not persist a log into the
database</li>
<li>  There are many null comparisons for the object across the system</li>
</ul>

<p>Take a look at the Special Case pattern if you didn&#39;t before. I&#39;m sure you will
find it very useful.</p>

</div>

<div class="related">
  <h2>Related Posts</h2>
  <ul class="related-posts">
    
      <li>
        <h3>
          <a href="/2014/03/source-code-ms-dos-word-windows/">
            Source Code for MS-DOS and Word for Windows
            <small>30 Mar 2014</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/2014/03/good-enough-software-design/">
            The Good Enough Software Design
            <small>09 Mar 2014</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/2014/01/developing-hadoop-projects-in-eclipse/">
            Developing Hadoop Projects in Eclipse
            <small>31 Jan 2014</small>
          </a>
        </h3>
      </li>
    
  </ul>
</div>


    <div id="disqus_thread"></div>
    <script type="text/javascript">
        var disqus_shortname = 'thingstocode';

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>



      </div>
    </div>

    <label for="sidebar-checkbox" class="sidebar-toggle"></label>

    <script>
      (function(document) {
        var toggle = document.querySelector('.sidebar-toggle');
        var sidebar = document.querySelector('#sidebar');
        var checkbox = document.querySelector('#sidebar-checkbox');

        document.addEventListener('click', function(e) {
          var target = e.target;

          if(!checkbox.checked ||
             sidebar.contains(target) ||
             (target === checkbox || target === toggle)) return;

          checkbox.checked = false;
        }, false);
      })(document);
    </script>

    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-47719261-1', 'auto');
  ga('send', 'pageview');

</script>

  </body>
</html>
